


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Arrow Flight RPC &mdash; Apache Arrow v4.0.0.dev2449+g4b8d1c2fd.d20210403</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Integration Testing" href="Integration.html" />
    <link rel="prev" title="Arrow Columnar Format" href="Columnar.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Apache Arrow
          

          
          </a>

          
            
            
              <div class="version">
                4.0.0.dev2449+g4b8d1c2fd.d20210403
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Specifications and Protocols</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Versioning.html">Format Versioning and Stability</a></li>
<li class="toctree-l1"><a class="reference internal" href="Columnar.html">Arrow Columnar Format</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Arrow Flight RPC</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#rpc-methods">RPC Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="#authentication">Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#error-handling">Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#external-resources">External Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="#protocol-buffer-definitions">Protocol Buffer Definitions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Integration.html">Integration Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="CDataInterface.html">The Arrow C data interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="CStreamInterface.html">The Arrow C stream interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Other.html">Other Data Structures</a></li>
</ul>
<p class="caption"><span class="caption-text">Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../status.html">Implementation Status</a></li>
<li class="toctree-l1"><a class="reference external" href="https://arrow.apache.org/docs/c_glib/">C/GLib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp/index.html">C++</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/apache/arrow/blob/master/csharp/README.md">C#</a></li>
<li class="toctree-l1"><a class="reference external" href="https://godoc.org/github.com/apache/arrow/go/arrow">Go</a></li>
<li class="toctree-l1"><a class="reference internal" href="../java/index.html">Java</a></li>
<li class="toctree-l1"><a class="reference external" href="https://arrow.apache.org/docs/js/">JavaScript</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/apache/arrow/blob/master/julia/Arrow/README.md">Julia</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/apache/arrow/blob/master/matlab/README.md">MATLAB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">Python</a></li>
<li class="toctree-l1"><a class="reference external" href="https://arrow.apache.org/docs/r/">R</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/apache/arrow/blob/master/ruby/README.md">Ruby</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.rs/crate/arrow/">Rust</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developers/contributing.html">Contributing to Apache Arrow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/cpp/index.html">C++ Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/python.html">Python Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/archery.html">Daily Development using Archery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/crossbow.html">Packaging and Testing with Crossbow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/docker.html">Running Docker Builds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/benchmarks.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/documentation.html">Building the Documentation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Apache Arrow</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Arrow Flight RPC</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/format/Flight.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="arrow-flight-rpc">
<span id="flight-rpc"></span><h1>Arrow Flight RPC<a class="headerlink" href="#arrow-flight-rpc" title="Permalink to this headline">¶</a></h1>
<p>Arrow Flight is an RPC framework for high-performance data services
based on Arrow data, and is built on top of <a class="reference external" href="https://grpc.io/">gRPC</a> and the <a class="reference internal" href="IPC.html"><span class="doc">IPC
format</span></a>.</p>
<p>Flight is organized around streams of Arrow record batches, being
either downloaded from or uploaded to another service. A set of
metadata methods offers discovery and introspection of streams, as
well as the ability to implement application-specific methods.</p>
<p>Methods and message wire formats are defined by Protobuf, enabling
interoperability with clients that may support gRPC and Arrow
separately, but not Flight. However, Flight implementations include
further optimizations to avoid overhead in usage of Protobuf (mostly
around avoiding excessive memory copies).</p>
<div class="section" id="rpc-methods">
<h2>RPC Methods<a class="headerlink" href="#rpc-methods" title="Permalink to this headline">¶</a></h2>
<p>Flight defines a set of RPC methods for uploading/downloading data,
retrieving metadata about a data stream, listing available data
streams, and for implementing application-specific RPC methods. A
Flight service implements some subset of these methods, while a Flight
client can call any of these methods. Thus, one Flight client can
connect to any Flight service and perform basic operations.</p>
<p>Data streams are identified by descriptors, which are either a path or
an arbitrary binary command. A client that wishes to download the data
would:</p>
<ol class="arabic">
<li><p>Construct or acquire a <code class="docutils literal notranslate"><span class="pre">FlightDescriptor</span></code> for the data set they
are interested in. A client may know what descriptor they want
already, or they may use methods like <code class="docutils literal notranslate"><span class="pre">ListFlights</span></code> to discover
them.</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">GetFlightInfo(FlightDescriptor)</span></code> to get a <code class="docutils literal notranslate"><span class="pre">FlightInfo</span></code>
message containing details on where the data is located (as well as
other metadata, like the schema and possibly an estimate of the
dataset size).</p>
<p>Flight does not require that data live on the same server as
metadata: this call may list other servers to connect to. The
<code class="docutils literal notranslate"><span class="pre">FlightInfo</span></code> message includes a <code class="docutils literal notranslate"><span class="pre">Ticket</span></code>, an opaque binary
token that the server uses to identify the exact data set being
requested.</p>
</li>
<li><p>Connect to other servers (if needed).</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">DoGet(Ticket)</span></code> to get back a stream of Arrow record
batches.</p></li>
</ol>
<p>To upload data, a client would:</p>
<ol class="arabic simple">
<li><p>Construct or acquire a <code class="docutils literal notranslate"><span class="pre">FlightDescriptor</span></code>, as before.</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">DoPut(FlightData)</span></code> and upload a stream of Arrow record
batches. They would also include the <code class="docutils literal notranslate"><span class="pre">FlightDescriptor</span></code> with the
first message.</p></li>
</ol>
<p>See <a class="reference internal" href="#protocol-buffer-definitions">Protocol Buffer Definitions</a> for full details on the methods and
messages involved.</p>
</div>
<div class="section" id="authentication">
<h2>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h2>
<p>Flight supports application-implemented authentication
methods. Authentication, if enabled, has two phases: at connection
time, the client and server can exchange any number of messages. Then,
the client can provide a token alongside each call, and the server can
validate that token.</p>
<p>Applications may use any part of this; for instance, they may ignore
the initial handshake and send an externally acquired token on each
call, or they may establish trust during the handshake and not
validate a token for each call. (Note that the latter is not secure if
you choose to deploy a layer 7 load balancer, as is common with gRPC.)</p>
</div>
<div class="section" id="error-handling">
<h2>Error Handling<a class="headerlink" href="#error-handling" title="Permalink to this headline">¶</a></h2>
<p>Arrow Flight defines its own set of error codes. The implementation
differs between languages (e.g. in C++, Unimplemented is a general
Arrow error status while it’s a Flight-specific exception in Java),
but the following set is exposed:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 73%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Error Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>UNKNOWN</p></td>
<td><p>An unknown error. The default if no other
error applies.</p></td>
</tr>
<tr class="row-odd"><td><p>INTERNAL</p></td>
<td><p>An error internal to the service
implementation occurred.</p></td>
</tr>
<tr class="row-even"><td><p>INVALID_ARGUMENT</p></td>
<td><p>The client passed an invalid argument to
the RPC.</p></td>
</tr>
<tr class="row-odd"><td><p>TIMED_OUT</p></td>
<td><p>The operation exceeded a timeout or
deadline.</p></td>
</tr>
<tr class="row-even"><td><p>NOT_FOUND</p></td>
<td><p>The requested resource (action, data
stream) was not found.</p></td>
</tr>
<tr class="row-odd"><td><p>ALREADY_EXISTS</p></td>
<td><p>The resource already exists.</p></td>
</tr>
<tr class="row-even"><td><p>CANCELLED</p></td>
<td><p>The operation was cancelled (either by the
client or the server).</p></td>
</tr>
<tr class="row-odd"><td><p>UNAUTHENTICATED</p></td>
<td><p>The client is not authenticated.</p></td>
</tr>
<tr class="row-even"><td><p>UNAUTHORIZED</p></td>
<td><p>The client is authenticated, but does not
have permissions for the requested
operation.</p></td>
</tr>
<tr class="row-odd"><td><p>UNIMPLEMENTED</p></td>
<td><p>The RPC is not implemented.</p></td>
</tr>
<tr class="row-even"><td><p>UNAVAILABLE</p></td>
<td><p>The server is not available. May be emitted
by the client for connectivity reasons.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="external-resources">
<h2>External Resources<a class="headerlink" href="#external-resources" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://arrow.apache.org/blog/2018/10/09/0.11.0-release/">https://arrow.apache.org/blog/2018/10/09/0.11.0-release/</a></p></li>
<li><p><a class="reference external" href="https://www.slideshare.net/JacquesNadeau5/apache-arrow-flight-overview">https://www.slideshare.net/JacquesNadeau5/apache-arrow-flight-overview</a></p></li>
</ul>
</div>
<div class="section" id="protocol-buffer-definitions">
<h2>Protocol Buffer Definitions<a class="headerlink" href="#protocol-buffer-definitions" title="Permalink to this headline">¶</a></h2>
<div class="highlight-protobuf notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * Licensed to the Apache Software Foundation (ASF) under one</span>
<span class="cm"> * or more contributor license agreements.  See the NOTICE file</span>
<span class="cm"> * distributed with this work for additional information</span>
<span class="cm"> * regarding copyright ownership.  The ASF licenses this file</span>
<span class="cm"> * to you under the Apache License, Version 2.0 (the</span>
<span class="cm"> * &quot;License&quot;); you may not use this file except in compliance</span>
<span class="cm"> * with the License.  You may obtain a copy of the License at</span>
<span class="cm"> * &lt;p&gt;</span>
<span class="cm"> * http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="cm"> * &lt;p&gt;</span>
<span class="cm"> * Unless required by applicable law or agreed to in writing, software</span>
<span class="cm"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="cm"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="cm"> * See the License for the specific language governing permissions and</span>
<span class="cm"> * limitations under the License.</span>
<span class="cm"> */</span>

<span class="k">syntax</span> <span class="o">=</span> <span class="s">&quot;proto3&quot;</span><span class="p">;</span>

<span class="k">option</span> <span class="na">java_package</span> <span class="o">=</span> <span class="s">&quot;org.apache.arrow.flight.impl&quot;</span><span class="p">;</span>
<span class="k">option</span> <span class="na">go_package</span> <span class="o">=</span> <span class="s">&quot;github.com/apache/arrow/go/flight;flight&quot;</span><span class="p">;</span>
<span class="k">option</span> <span class="na">csharp_namespace</span> <span class="o">=</span> <span class="s">&quot;Apache.Arrow.Flight.Protocol&quot;</span><span class="p">;</span>

<span class="kn">package</span> <span class="nn">arrow</span><span class="o">.</span><span class="n">flight.protocol</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * A flight service is an endpoint for retrieving or storing Arrow data. A</span>
<span class="cm"> * flight service can expose one or more predefined endpoints that can be</span>
<span class="cm"> * accessed using the Arrow Flight Protocol. Additionally, a flight service</span>
<span class="cm"> * can expose a set of actions that are available.</span>
<span class="cm"> */</span>
<span class="kd">service</span> <span class="n">FlightService</span> <span class="p">{</span>

  <span class="cm">/*</span>
<span class="cm">   * Handshake between client and server. Depending on the server, the</span>
<span class="cm">   * handshake may be required to determine the token that should be used for</span>
<span class="cm">   * future operations. Both request and response are streams to allow multiple</span>
<span class="cm">   * round-trips depending on auth mechanism.</span>
<span class="cm">   */</span>
  <span class="k">rpc</span> <span class="n">Handshake</span><span class="p">(</span><span class="n">stream</span> <span class="n">HandshakeRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">stream</span> <span class="n">HandshakeResponse</span><span class="p">)</span> <span class="p">{}</span>

  <span class="cm">/*</span>
<span class="cm">   * Get a list of available streams given a particular criteria. Most flight</span>
<span class="cm">   * services will expose one or more streams that are readily available for</span>
<span class="cm">   * retrieval. This api allows listing the streams available for</span>
<span class="cm">   * consumption. A user can also provide a criteria. The criteria can limit</span>
<span class="cm">   * the subset of streams that can be listed via this interface. Each flight</span>
<span class="cm">   * service allows its own definition of how to consume criteria.</span>
<span class="cm">   */</span>
  <span class="k">rpc</span> <span class="n">ListFlights</span><span class="p">(</span><span class="n">Criteria</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">stream</span> <span class="n">FlightInfo</span><span class="p">)</span> <span class="p">{}</span>

  <span class="cm">/*</span>
<span class="cm">   * For a given FlightDescriptor, get information about how the flight can be</span>
<span class="cm">   * consumed. This is a useful interface if the consumer of the interface</span>
<span class="cm">   * already can identify the specific flight to consume. This interface can</span>
<span class="cm">   * also allow a consumer to generate a flight stream through a specified</span>
<span class="cm">   * descriptor. For example, a flight descriptor might be something that</span>
<span class="cm">   * includes a SQL statement or a Pickled Python operation that will be</span>
<span class="cm">   * executed. In those cases, the descriptor will not be previously available</span>
<span class="cm">   * within the list of available streams provided by ListFlights but will be</span>
<span class="cm">   * available for consumption for the duration defined by the specific flight</span>
<span class="cm">   * service.</span>
<span class="cm">   */</span>
  <span class="k">rpc</span> <span class="n">GetFlightInfo</span><span class="p">(</span><span class="n">FlightDescriptor</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">FlightInfo</span><span class="p">)</span> <span class="p">{}</span>

  <span class="cm">/*</span>
<span class="cm">   * For a given FlightDescriptor, get the Schema as described in Schema.fbs::Schema</span>
<span class="cm">   * This is used when a consumer needs the Schema of flight stream. Similar to</span>
<span class="cm">   * GetFlightInfo this interface may generate a new flight that was not previously</span>
<span class="cm">   * available in ListFlights.</span>
<span class="cm">   */</span>
   <span class="k">rpc</span> <span class="n">GetSchema</span><span class="p">(</span><span class="n">FlightDescriptor</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">SchemaResult</span><span class="p">)</span> <span class="p">{}</span>

  <span class="cm">/*</span>
<span class="cm">   * Retrieve a single stream associated with a particular descriptor</span>
<span class="cm">   * associated with the referenced ticket. A Flight can be composed of one or</span>
<span class="cm">   * more streams where each stream can be retrieved using a separate opaque</span>
<span class="cm">   * ticket that the flight service uses for managing a collection of streams.</span>
<span class="cm">   */</span>
  <span class="k">rpc</span> <span class="n">DoGet</span><span class="p">(</span><span class="n">Ticket</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">stream</span> <span class="n">FlightData</span><span class="p">)</span> <span class="p">{}</span>

  <span class="cm">/*</span>
<span class="cm">   * Push a stream to the flight service associated with a particular</span>
<span class="cm">   * flight stream. This allows a client of a flight service to upload a stream</span>
<span class="cm">   * of data. Depending on the particular flight service, a client consumer</span>
<span class="cm">   * could be allowed to upload a single stream per descriptor or an unlimited</span>
<span class="cm">   * number. In the latter, the service might implement a &#39;seal&#39; action that</span>
<span class="cm">   * can be applied to a descriptor once all streams are uploaded.</span>
<span class="cm">   */</span>
  <span class="k">rpc</span> <span class="n">DoPut</span><span class="p">(</span><span class="n">stream</span> <span class="n">FlightData</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">stream</span> <span class="n">PutResult</span><span class="p">)</span> <span class="p">{}</span>

  <span class="cm">/*</span>
<span class="cm">   * Open a bidirectional data channel for a given descriptor. This</span>
<span class="cm">   * allows clients to send and receive arbitrary Arrow data and</span>
<span class="cm">   * application-specific metadata in a single logical stream. In</span>
<span class="cm">   * contrast to DoGet/DoPut, this is more suited for clients</span>
<span class="cm">   * offloading computation (rather than storage) to a Flight service.</span>
<span class="cm">   */</span>
  <span class="k">rpc</span> <span class="n">DoExchange</span><span class="p">(</span><span class="n">stream</span> <span class="n">FlightData</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">stream</span> <span class="n">FlightData</span><span class="p">)</span> <span class="p">{}</span>

  <span class="cm">/*</span>
<span class="cm">   * Flight services can support an arbitrary number of simple actions in</span>
<span class="cm">   * addition to the possible ListFlights, GetFlightInfo, DoGet, DoPut</span>
<span class="cm">   * operations that are potentially available. DoAction allows a flight client</span>
<span class="cm">   * to do a specific action against a flight service. An action includes</span>
<span class="cm">   * opaque request and response objects that are specific to the type action</span>
<span class="cm">   * being undertaken.</span>
<span class="cm">   */</span>
  <span class="k">rpc</span> <span class="n">DoAction</span><span class="p">(</span><span class="n">Action</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">stream</span> <span class="n">Result</span><span class="p">)</span> <span class="p">{}</span>

  <span class="cm">/*</span>
<span class="cm">   * A flight service exposes all of the available action types that it has</span>
<span class="cm">   * along with descriptions. This allows different flight consumers to</span>
<span class="cm">   * understand the capabilities of the flight service.</span>
<span class="cm">   */</span>
  <span class="k">rpc</span> <span class="n">ListActions</span><span class="p">(</span><span class="n">Empty</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">stream</span> <span class="n">ActionType</span><span class="p">)</span> <span class="p">{}</span>

<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * The request that a client provides to a server on handshake.</span>
<span class="cm"> */</span>
<span class="kd">message</span> <span class="nc">HandshakeRequest</span> <span class="p">{</span>

  <span class="cm">/*</span>
<span class="cm">   * A defined protocol version</span>
<span class="cm">   */</span>
  <span class="kt">uint64</span> <span class="na">protocol_version</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="cm">/*</span>
<span class="cm">   * Arbitrary auth/handshake info.</span>
<span class="cm">   */</span>
  <span class="kt">bytes</span> <span class="na">payload</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span> <span class="nc">HandshakeResponse</span> <span class="p">{</span>

  <span class="cm">/*</span>
<span class="cm">   * A defined protocol version</span>
<span class="cm">   */</span>
  <span class="kt">uint64</span> <span class="na">protocol_version</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="cm">/*</span>
<span class="cm">   * Arbitrary auth/handshake info.</span>
<span class="cm">   */</span>
  <span class="kt">bytes</span> <span class="na">payload</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * A message for doing simple auth.</span>
<span class="cm"> */</span>
<span class="kd">message</span> <span class="nc">BasicAuth</span> <span class="p">{</span>
  <span class="kt">string</span> <span class="na">username</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="kt">string</span> <span class="na">password</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span> <span class="nc">Empty</span> <span class="p">{}</span>

<span class="cm">/*</span>
<span class="cm"> * Describes an available action, including both the name used for execution</span>
<span class="cm"> * along with a short description of the purpose of the action.</span>
<span class="cm"> */</span>
<span class="kd">message</span> <span class="nc">ActionType</span> <span class="p">{</span>
  <span class="kt">string</span> <span class="na">type</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="kt">string</span> <span class="na">description</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * A service specific expression that can be used to return a limited set</span>
<span class="cm"> * of available Arrow Flight streams.</span>
<span class="cm"> */</span>
<span class="kd">message</span> <span class="nc">Criteria</span> <span class="p">{</span>
  <span class="kt">bytes</span> <span class="na">expression</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * An opaque action specific for the service.</span>
<span class="cm"> */</span>
<span class="kd">message</span> <span class="nc">Action</span> <span class="p">{</span>
  <span class="kt">string</span> <span class="na">type</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="kt">bytes</span> <span class="na">body</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * An opaque result returned after executing an action.</span>
<span class="cm"> */</span>
<span class="kd">message</span> <span class="nc">Result</span> <span class="p">{</span>
  <span class="kt">bytes</span> <span class="na">body</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * Wrap the result of a getSchema call</span>
<span class="cm"> */</span>
<span class="kd">message</span> <span class="nc">SchemaResult</span> <span class="p">{</span>
  <span class="c1">// schema of the dataset as described in Schema.fbs::Schema.</span>
  <span class="kt">bytes</span> <span class="na">schema</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * The name or tag for a Flight. May be used as a way to retrieve or generate</span>
<span class="cm"> * a flight or be used to expose a set of previously defined flights.</span>
<span class="cm"> */</span>
<span class="kd">message</span> <span class="nc">FlightDescriptor</span> <span class="p">{</span>

  <span class="cm">/*</span>
<span class="cm">   * Describes what type of descriptor is defined.</span>
<span class="cm">   */</span>
  <span class="kd">enum</span> <span class="n">DescriptorType</span> <span class="p">{</span>

    <span class="c1">// Protobuf pattern, not used.</span>
    <span class="na">UNKNOWN</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="cm">/*</span>
<span class="cm">     * A named path that identifies a dataset. A path is composed of a string</span>
<span class="cm">     * or list of strings describing a particular dataset. This is conceptually</span>
<span class="cm">     *  similar to a path inside a filesystem.</span>
<span class="cm">     */</span>
    <span class="na">PATH</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="cm">/*</span>
<span class="cm">     * An opaque command to generate a dataset.</span>
<span class="cm">     */</span>
    <span class="na">CMD</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">DescriptorType</span> <span class="na">type</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="cm">/*</span>
<span class="cm">   * Opaque value used to express a command. Should only be defined when</span>
<span class="cm">   * type = CMD.</span>
<span class="cm">   */</span>
  <span class="kt">bytes</span> <span class="na">cmd</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

  <span class="cm">/*</span>
<span class="cm">   * List of strings identifying a particular dataset. Should only be defined</span>
<span class="cm">   * when type = PATH.</span>
<span class="cm">   */</span>
  <span class="k">repeated</span> <span class="kt">string</span> <span class="na">path</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * The access coordinates for retrieval of a dataset. With a FlightInfo, a</span>
<span class="cm"> * consumer is able to determine how to retrieve a dataset.</span>
<span class="cm"> */</span>
<span class="kd">message</span> <span class="nc">FlightInfo</span> <span class="p">{</span>
  <span class="c1">// schema of the dataset as described in Schema.fbs::Schema.</span>
  <span class="kt">bytes</span> <span class="na">schema</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="cm">/*</span>
<span class="cm">   * The descriptor associated with this info.</span>
<span class="cm">   */</span>
  <span class="n">FlightDescriptor</span> <span class="na">flight_descriptor</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

  <span class="cm">/*</span>
<span class="cm">   * A list of endpoints associated with the flight. To consume the whole</span>
<span class="cm">   * flight, all endpoints must be consumed.</span>
<span class="cm">   */</span>
  <span class="k">repeated</span> <span class="n">FlightEndpoint</span> <span class="na">endpoint</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

  <span class="c1">// Set these to -1 if unknown.</span>
  <span class="kt">int64</span> <span class="na">total_records</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
  <span class="kt">int64</span> <span class="na">total_bytes</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * A particular stream or split associated with a flight.</span>
<span class="cm"> */</span>
<span class="kd">message</span> <span class="nc">FlightEndpoint</span> <span class="p">{</span>

  <span class="cm">/*</span>
<span class="cm">   * Token used to retrieve this stream.</span>
<span class="cm">   */</span>
  <span class="n">Ticket</span> <span class="na">ticket</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="cm">/*</span>
<span class="cm">   * A list of URIs where this ticket can be redeemed. If the list is</span>
<span class="cm">   * empty, the expectation is that the ticket can only be redeemed on the</span>
<span class="cm">   * current service where the ticket was generated.</span>
<span class="cm">   */</span>
  <span class="k">repeated</span> <span class="n">Location</span> <span class="na">location</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * A location where a Flight service will accept retrieval of a particular</span>
<span class="cm"> * stream given a ticket.</span>
<span class="cm"> */</span>
<span class="kd">message</span> <span class="nc">Location</span> <span class="p">{</span>
  <span class="kt">string</span> <span class="na">uri</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * An opaque identifier that the service can use to retrieve a particular</span>
<span class="cm"> * portion of a stream.</span>
<span class="cm"> */</span>
<span class="kd">message</span> <span class="nc">Ticket</span> <span class="p">{</span>
  <span class="kt">bytes</span> <span class="na">ticket</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * A batch of Arrow data as part of a stream of batches.</span>
<span class="cm"> */</span>
<span class="kd">message</span> <span class="nc">FlightData</span> <span class="p">{</span>

  <span class="cm">/*</span>
<span class="cm">   * The descriptor of the data. This is only relevant when a client is</span>
<span class="cm">   * starting a new DoPut stream.</span>
<span class="cm">   */</span>
  <span class="n">FlightDescriptor</span> <span class="na">flight_descriptor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="cm">/*</span>
<span class="cm">   * Header for message data as described in Message.fbs::Message.</span>
<span class="cm">   */</span>
  <span class="kt">bytes</span> <span class="na">data_header</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

  <span class="cm">/*</span>
<span class="cm">   * Application-defined metadata.</span>
<span class="cm">   */</span>
  <span class="kt">bytes</span> <span class="na">app_metadata</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

  <span class="cm">/*</span>
<span class="cm">   * The actual batch of Arrow data. Preferably handled with minimal-copies</span>
<span class="cm">   * coming last in the definition to help with sidecar patterns (it is</span>
<span class="cm">   * expected that some implementations will fetch this field off the wire</span>
<span class="cm">   * with specialized code to avoid extra memory copies).</span>
<span class="cm">   */</span>
  <span class="kt">bytes</span> <span class="na">data_body</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * The response message associated with the submission of a DoPut.</span>
<span class="cm"> */</span>
<span class="kd">message</span> <span class="nc">PutResult</span> <span class="p">{</span>
  <span class="kt">bytes</span> <span class="na">app_metadata</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Integration.html" class="btn btn-neutral float-right" title="Integration Testing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Columnar.html" class="btn btn-neutral float-left" title="Arrow Columnar Format" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2016-2019 Apache Software Foundation.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-107500873-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-107500873-1');
</script>


</body>
</html>